
import { getRandomString } from "@pnp/common";
import { expect } from "chai";
import { testSettings } from "../main";
import { IAppCatalog } from '@pnp/sp/src/appcatalog';
import { IWeb } from '@pnp/sp/src/webs';
import { sp } from "@pnp/sp";
import "@pnp/sp/src/webs";
import "@pnp/sp/src/appcatalog";
import "@pnp/sp/src/lists";
// const { createReadStream } = require('fs');

describe.only("AppCatalog", function () {

    if (testSettings.enableWebTests) {
        let appCatalog: IAppCatalog;
        let appCatWeb: IWeb;
        // const stream = createReadStream('C:\\p\\helloworld\\sharepoint\\solution\\helloworld.sppkg');

        // const b64EncodedSolution = "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";
        // const shit = Buffer.from(b64EncodedSolution);

        const x = [80, 75, 3, 4, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 240, 84, 60, 165, 178, 0, 0, 0, 32, 1, 0, 0, 11, 0, 0, 0, 95, 114, 101, 108, 115, 47, 46, 114, 101, 108, 115, 101, 142, 65, 110, 2, 49, 12, 69, 175, 18, 121, 207, 120, 96, 81, 161, 138, 128, 88, 178, 96, 83, 113, 1, 43, 120, 102, 162, 146, 196, 138, 13, 130, 219, 147, 69, 43, 205, 180, 203, 111, 127, 63, 191, 221, 225, 153, 110, 238, 193, 85, 99, 201, 30, 214, 93, 15, 142, 115, 40, 215, 152, 71, 15, 119, 27, 86, 91, 56, 236, 119, 95, 124, 35, 107, 13, 157, 162, 168, 107, 39, 89, 61, 76, 102, 242, 137, 168, 97, 226, 68, 218, 21, 225, 220, 54, 67, 169, 137, 172, 197, 58, 162, 80, 248, 166, 145, 113, 211, 247, 31, 88, 231, 12, 88, 50, 221, 229, 37, 252, 143, 152, 98, 168, 69, 203, 96, 93, 40, 9, 117, 162, 202, 82, 98, 182, 198, 91, 111, 144, 68, 150, 204, 223, 119, 171, 68, 57, 14, 172, 6, 238, 66, 117, 100, 243, 128, 71, 145, 243, 207, 180, 107, 146, 224, 78, 87, 15, 181, 111, 26, 56, 247, 248, 19, 117, 255, 6, 80, 75, 3, 4, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 133, 165, 247, 229, 234, 0, 0, 0, 96, 1, 0, 0, 15, 0, 0, 0, 65, 112, 112, 77, 97, 110, 105, 102, 101, 115, 116, 46, 120, 109, 108, 133, 144, 203, 78, 195, 48, 16, 69, 127, 197, 242, 222, 113, 220, 90, 77, 64, 78, 42, 4, 155, 46, 64, 149, 130, 216, 7, 123, 220, 88, 242, 75, 182, 3, 124, 62, 14, 15, 209, 29, 154, 229, 189, 51, 231, 104, 196, 241, 195, 89, 244, 6, 41, 155, 224, 7, 204, 154, 22, 35, 240, 50, 40, 227, 47, 3, 94, 139, 38, 61, 62, 142, 226, 46, 70, 84, 139, 62, 15, 120, 41, 37, 222, 82, 154, 229, 2, 110, 206, 141, 51, 50, 133, 28, 116, 105, 100, 112, 52, 47, 115, 130, 24, 140, 47, 116, 215, 178, 29, 157, 99, 164, 110, 246, 70, 67, 46, 24, 61, 205, 14, 234, 1, 176, 54, 188, 135, 100, 21, 145, 214, 128, 47, 36, 27, 5, 36, 7, 187, 150, 42, 129, 209, 57, 5, 181, 202, 114, 122, 24, 240, 43, 227, 237, 94, 237, 37, 81, 92, 114, 194, 153, 238, 72, 207, 56, 35, 93, 119, 208, 154, 241, 155, 158, 181, 85, 248, 229, 74, 127, 27, 140, 166, 205, 227, 188, 121, 60, 26, 255, 23, 31, 126, 243, 83, 190, 255, 66, 79, 149, 60, 253, 128, 7, 92, 210, 10, 120, 20, 149, 31, 33, 21, 3, 121, 20, 207, 166, 88, 24, 255, 81, 22, 244, 187, 38, 232, 245, 42, 173, 79, 27, 63, 1, 80, 75, 3, 4, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 139, 120, 221, 20, 204, 0, 0, 0, 65, 1, 0, 0, 26, 0, 0, 0, 95, 114, 101, 108, 115, 47, 65, 112, 112, 77, 97, 110, 105, 102, 101, 115, 116, 46, 120, 109, 108, 46, 114, 101, 108, 115, 101, 143, 189, 110, 195, 48, 12, 132, 95, 69, 224, 46, 75, 113, 2, 195, 45, 162, 100, 238, 90, 100, 47, 40, 153, 178, 133, 68, 63, 144, 152, 162, 125, 251, 106, 232, 144, 180, 227, 29, 239, 62, 28, 143, 231, 175, 120, 19, 159, 84, 91, 200, 201, 192, 110, 208, 32, 40, 185, 188, 132, 180, 26, 184, 179, 151, 51, 156, 79, 199, 119, 186, 33, 247, 68, 219, 66, 105, 162, 87, 82, 51, 176, 49, 151, 87, 165, 154, 219, 40, 98, 27, 114, 161, 212, 47, 62, 215, 136, 220, 101, 93, 85, 65, 119, 197, 149, 212, 168, 245, 164, 234, 35, 3, 158, 153, 226, 242, 93, 232, 31, 49, 6, 87, 115, 203, 158, 7, 151, 163, 106, 27, 86, 42, 57, 36, 238, 188, 221, 168, 176, 148, 103, 166, 138, 152, 130, 167, 198, 210, 19, 242, 189, 18, 136, 11, 214, 149, 216, 128, 250, 117, 62, 200, 249, 201, 34, 89, 105, 181, 123, 145, 7, 123, 112, 18, 103, 28, 165, 221, 143, 86, 207, 56, 45, 206, 227, 208, 191, 0, 241, 182, 24, 168, 251, 190, 83, 61, 14, 253, 35, 219, 233, 7, 80, 75, 3, 4, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 186, 198, 161, 138, 248, 0, 0, 0, 48, 2, 0, 0, 59, 0, 0, 0, 95, 114, 101, 108, 115, 47, 102, 101, 97, 116, 117, 114, 101, 95, 101, 99, 102, 54, 98, 97, 101, 98, 45, 98, 48, 99, 57, 45, 52, 98, 52, 99, 45, 97, 56, 97, 50, 45, 98, 51, 50, 98, 48, 56, 97, 54, 100, 99, 102, 97, 46, 120, 109, 108, 46, 114, 101, 108, 115, 181, 144, 61, 111, 195, 32, 16, 134, 255, 10, 98, 199, 56, 110, 100, 185, 85, 156, 204, 221, 170, 42, 82, 199, 234, 192, 135, 141, 98, 62, 4, 231, 170, 253, 247, 165, 109, 6, 91, 89, 178, 116, 227, 224, 238, 185, 247, 225, 112, 250, 116, 51, 251, 192, 148, 109, 240, 61, 223, 85, 53, 103, 232, 117, 24, 172, 31, 123, 190, 144, 17, 29, 63, 29, 15, 175, 56, 3, 149, 142, 60, 217, 152, 89, 25, 241, 185, 231, 19, 81, 124, 146, 50, 235, 9, 29, 228, 42, 68, 244, 229, 197, 132, 228, 128, 74, 153, 70, 25, 65, 95, 96, 68, 217, 212, 117, 43, 211, 154, 193, 183, 76, 118, 254, 138, 120, 67, 116, 86, 167, 144, 131, 161, 74, 7, 39, 243, 4, 9, 99, 176, 158, 10, 111, 215, 72, 136, 113, 203, 44, 235, 18, 233, 224, 141, 29, 151, 244, 123, 205, 217, 25, 210, 136, 212, 115, 105, 16, 104, 73, 248, 142, 218, 180, 10, 80, 9, 85, 235, 71, 177, 87, 123, 45, 160, 131, 70, 168, 135, 70, 213, 29, 180, 131, 54, 80, 21, 141, 234, 15, 244, 115, 228, 236, 121, 232, 121, 218, 149, 204, 114, 29, 250, 63, 20, 174, 49, 5, 206, 232, 208, 147, 3, 111, 13, 102, 90, 137, 220, 35, 32, 223, 80, 189, 148, 207, 184, 219, 246, 170, 216, 220, 42, 110, 202, 124, 252, 6, 80, 75, 3, 4, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 4, 69, 15, 219, 222, 0, 0, 0, 17, 3, 0, 0, 19, 0, 0, 0, 91, 67, 111, 110, 116, 101, 110, 116, 95, 84, 121, 112, 101, 115, 93, 46, 120, 109, 108, 165, 146, 77, 110, 194, 48, 16, 133, 175, 98, 121, 91, 37, 78, 89, 84, 8, 37, 97, 65, 185, 65, 47, 96, 204, 196, 113, 27, 219, 35, 207, 0, 225, 246, 56, 192, 10, 85, 253, 9, 75, 207, 188, 239, 189, 167, 145, 235, 245, 232, 7, 113, 132, 68, 46, 134, 70, 190, 150, 149, 20, 16, 76, 220, 187, 96, 27, 121, 224, 174, 88, 202, 117, 91, 127, 156, 17, 72, 100, 105, 160, 70, 246, 204, 184, 82, 138, 76, 15, 94, 83, 25, 17, 66, 222, 116, 49, 121, 205, 249, 153, 172, 66, 109, 190, 180, 5, 181, 168, 170, 55, 101, 98, 96, 8, 92, 240, 228, 33, 219, 250, 29, 58, 125, 24, 88, 108, 199, 60, 190, 197, 102, 92, 138, 205, 77, 55, 69, 53, 146, 97, 100, 53, 141, 219, 90, 221, 129, 111, 201, 4, 3, 61, 160, 26, 113, 112, 70, 115, 222, 171, 99, 216, 63, 244, 43, 238, 221, 202, 76, 94, 53, 212, 59, 164, 151, 63, 68, 157, 96, 135, 58, 241, 204, 162, 61, 251, 153, 164, 38, 28, 103, 95, 135, 230, 162, 24, 236, 15, 119, 61, 17, 254, 102, 240, 137, 79, 26, 88, 215, 61, 103, 176, 243, 248, 15, 3, 117, 253, 227, 237, 5, 80, 75, 3, 4, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 244, 193, 250, 136, 18, 3, 0, 0, 37, 8, 0, 0, 85, 0, 0, 0, 101, 99, 102, 54, 98, 97, 101, 98, 45, 98, 48, 99, 57, 45, 52, 98, 52, 99, 45, 97, 56, 97, 50, 45, 98, 51, 50, 98, 48, 56, 97, 54, 100, 99, 102, 97, 47, 87, 101, 98, 80, 97, 114, 116, 95, 101, 99, 102, 54, 98, 97, 101, 98, 45, 98, 48, 99, 57, 45, 52, 98, 52, 99, 45, 97, 56, 97, 50, 45, 98, 51, 50, 98, 48, 56, 97, 54, 100, 99, 102, 97, 46, 120, 109, 108, 173, 85, 77, 111, 219, 56, 16, 253, 43, 90, 29, 114, 42, 109, 82, 162, 190, 154, 56, 253, 72, 91, 36, 192, 182, 53, 218, 116, 123, 88, 44, 2, 138, 28, 217, 44, 104, 81, 37, 169, 102, 179, 133, 255, 251, 210, 145, 108, 131, 137, 147, 244, 80, 93, 72, 73, 51, 15, 111, 102, 222, 204, 156, 188, 248, 119, 165, 162, 31, 96, 172, 212, 237, 44, 38, 19, 28, 71, 208, 114, 45, 100, 187, 152, 197, 189, 107, 80, 25, 191, 56, 61, 121, 171, 96, 5, 173, 179, 145, 183, 110, 237, 44, 94, 58, 215, 61, 159, 78, 45, 95, 194, 138, 217, 201, 74, 114, 163, 173, 110, 220, 132, 235, 213, 212, 46, 153, 129, 78, 203, 214, 77, 227, 211, 147, 51, 37, 189, 231, 103, 41, 224, 76, 175, 58, 221, 250, 151, 232, 3, 91, 193, 44, 62, 7, 165, 244, 87, 109, 148, 136, 163, 11, 49, 139, 129, 55, 121, 205, 160, 70, 53, 230, 21, 162, 53, 229, 136, 149, 44, 65, 117, 154, 212, 184, 100, 185, 224, 13, 139, 163, 29, 202, 123, 214, 202, 6, 172, 155, 197, 63, 143, 190, 247, 218, 29, 75, 49, 156, 207, 135, 227, 87, 224, 6, 203, 103, 195, 193, 148, 100, 54, 128, 216, 51, 252, 10, 245, 156, 25, 23, 216, 243, 45, 147, 203, 155, 14, 2, 191, 67, 214, 99, 142, 3, 59, 60, 193, 19, 18, 88, 173, 198, 160, 254, 10, 172, 147, 241, 111, 103, 128, 235, 182, 145, 139, 222, 128, 120, 219, 58, 35, 97, 75, 248, 239, 49, 9, 11, 163, 251, 238, 34, 204, 68, 198, 113, 74, 72, 5, 40, 197, 5, 69, 52, 111, 4, 170, 138, 188, 70, 60, 199, 164, 42, 253, 175, 166, 192, 1, 139, 91, 144, 17, 98, 196, 21, 208, 176, 94, 185, 0, 247, 163, 91, 130, 25, 174, 235, 209, 211, 73, 167, 224, 105, 207, 125, 98, 67, 119, 1, 150, 27, 217, 185, 125, 232, 191, 4, 18, 221, 243, 219, 2, 234, 166, 145, 28, 222, 177, 218, 72, 126, 225, 115, 247, 78, 183, 110, 163, 190, 0, 104, 206, 22, 16, 196, 223, 25, 221, 129, 113, 251, 236, 254, 124, 136, 222, 3, 225, 172, 255, 25, 145, 148, 102, 2, 204, 217, 109, 209, 66, 44, 175, 27, 115, 243, 94, 139, 94, 193, 157, 114, 45, 55, 104, 232, 122, 3, 135, 174, 189, 126, 187, 187, 82, 242, 157, 5, 166, 101, 106, 240, 126, 205, 44, 124, 49, 106, 39, 132, 225, 60, 82, 238, 248, 15, 132, 162, 249, 171, 203, 243, 232, 242, 99, 116, 246, 230, 67, 132, 208, 209, 194, 29, 79, 7, 131, 45, 195, 33, 162, 79, 96, 117, 111, 248, 221, 128, 31, 166, 178, 181, 112, 119, 181, 223, 49, 183, 12, 147, 185, 251, 240, 72, 124, 87, 56, 101, 13, 73, 132, 32, 5, 23, 137, 104, 120, 202, 235, 82, 164, 105, 142, 41, 75, 112, 9, 249, 228, 155, 13, 43, 123, 175, 55, 63, 251, 118, 104, 23, 247, 42, 118, 171, 155, 249, 65, 14, 3, 133, 253, 213, 147, 217, 112, 177, 3, 208, 21, 180, 168, 183, 87, 89, 154, 67, 158, 17, 90, 213, 152, 241, 134, 138, 44, 225, 24, 83, 223, 73, 105, 93, 53, 60, 171, 118, 196, 158, 61, 144, 16, 165, 185, 159, 44, 255, 129, 152, 31, 202, 204, 142, 239, 122, 27, 216, 203, 221, 52, 157, 218, 14, 113, 109, 0, 41, 89, 27, 102, 110, 158, 200, 252, 110, 30, 61, 57, 119, 200, 196, 15, 250, 80, 82, 161, 4, 139, 36, 79, 121, 33, 48, 34, 34, 103, 136, 102, 192, 81, 41, 202, 12, 9, 42, 136, 72, 82, 74, 10, 82, 135, 229, 8, 89, 43, 45, 152, 93, 34, 219, 215, 22, 158, 18, 204, 239, 164, 157, 2, 17, 60, 247, 100, 41, 37, 136, 38, 220, 143, 124, 65, 11, 63, 252, 69, 154, 103, 85, 83, 178, 148, 61, 70, 123, 20, 0, 170, 125, 75, 253, 86, 214, 228, 49, 214, 85, 65, 89, 225, 31, 132, 171, 10, 35, 74, 210, 28, 149, 13, 203, 81, 149, 137, 18, 19, 66, 121, 2, 120, 59, 87, 214, 235, 56, 218, 172, 155, 89, 60, 170, 222, 111, 216, 233, 129, 21, 123, 122, 50, 12, 135, 3, 171, 214, 207, 138, 89, 124, 197, 153, 99, 74, 47, 236, 244, 186, 139, 163, 63, 229, 102, 141, 18, 146, 110, 208, 6, 71, 127, 217, 46, 253, 211, 255, 1, 80, 75, 3, 4, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 237, 90, 181, 251, 223, 0, 0, 0, 45, 1, 0, 0, 48, 0, 0, 0, 102, 101, 97, 116, 117, 114, 101, 95, 101, 99, 102, 54, 98, 97, 101, 98, 45, 98, 48, 99, 57, 45, 52, 98, 52, 99, 45, 97, 56, 97, 50, 45, 98, 51, 50, 98, 48, 56, 97, 54, 100, 99, 102, 97, 46, 120, 109, 108, 77, 143, 95, 75, 196, 48, 16, 196, 191, 202, 178, 239, 253, 227, 121, 28, 85, 218, 30, 135, 122, 156, 224, 131, 80, 241, 158, 147, 205, 214, 4, 210, 164, 36, 123, 167, 31, 223, 42, 5, 101, 30, 103, 248, 205, 76, 187, 255, 154, 60, 92, 57, 101, 23, 67, 135, 55, 101, 141, 192, 129, 162, 113, 225, 163, 195, 139, 140, 69, 131, 251, 190, 61, 178, 146, 75, 98, 88, 194, 33, 119, 104, 69, 230, 251, 170, 202, 100, 121, 82, 185, 156, 28, 165, 152, 227, 40, 37, 197, 169, 202, 86, 37, 158, 163, 11, 82, 33, 188, 57, 241, 220, 225, 137, 189, 143, 231, 152, 188, 129, 21, 133, 240, 200, 153, 146, 155, 229, 183, 248, 0, 227, 90, 241, 105, 29, 89, 80, 36, 238, 170, 132, 51, 136, 101, 120, 240, 142, 131, 20, 131, 51, 12, 103, 214, 175, 42, 9, 4, 53, 177, 129, 63, 48, 194, 179, 233, 144, 105, 220, 105, 197, 186, 208, 53, 221, 21, 91, 189, 165, 66, 53, 106, 83, 232, 219, 141, 174, 27, 181, 51, 52, 42, 132, 247, 127, 127, 127, 132, 48, 80, 156, 151, 157, 11, 28, 225, 228, 140, 225, 197, 60, 30, 94, 134, 39, 236, 219, 106, 157, 220, 127, 3, 80, 75, 3, 4, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 185, 172, 165, 195, 152, 0, 0, 0, 189, 0, 0, 0, 59, 0, 0, 0, 102, 101, 97, 116, 117, 114, 101, 95, 101, 99, 102, 54, 98, 97, 101, 98, 45, 98, 48, 99, 57, 45, 52, 98, 52, 99, 45, 97, 56, 97, 50, 45, 98, 51, 50, 98, 48, 56, 97, 54, 100, 99, 102, 97, 46, 120, 109, 108, 46, 99, 111, 110, 102, 105, 103, 46, 120, 109, 108, 85, 142, 203, 14, 194, 32, 20, 5, 127, 165, 97, 79, 65, 108, 154, 106, 40, 141, 113, 229, 206, 95, 184, 220, 66, 75, 34, 143, 0, 53, 126, 190, 196, 157, 251, 57, 115, 70, 46, 31, 255, 234, 222, 38, 23, 23, 195, 76, 78, 61, 39, 157, 9, 24, 87, 23, 182, 153, 28, 213, 210, 137, 44, 74, 222, 82, 122, 66, 174, 247, 24, 172, 219, 186, 54, 9, 101, 38, 123, 173, 233, 202, 88, 193, 221, 120, 40, 189, 119, 152, 99, 137, 182, 246, 24, 61, 43, 59, 100, 147, 162, 11, 149, 9, 126, 18, 12, 82, 98, 169, 41, 240, 167, 56, 50, 212, 118, 72, 148, 124, 172, 202, 160, 29, 53, 24, 77, 53, 199, 11, 29, 244, 128, 20, 38, 16, 84, 159, 133, 230, 19, 140, 43, 90, 144, 172, 129, 146, 253, 117, 168, 47, 80, 75, 1, 2, 20, 0, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 240, 84, 60, 165, 178, 0, 0, 0, 32, 1, 0, 0, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 95, 114, 101, 108, 115, 47, 46, 114, 101, 108, 115, 80, 75, 1, 2, 20, 0, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 133, 165, 247, 229, 234, 0, 0, 0, 96, 1, 0, 0, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 219, 0, 0, 0, 65, 112, 112, 77, 97, 110, 105, 102, 101, 115, 116, 46, 120, 109, 108, 80, 75, 1, 2, 20, 0, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 139, 120, 221, 20, 204, 0, 0, 0, 65, 1, 0, 0, 26, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 242, 1, 0, 0, 95, 114, 101, 108, 115, 47, 65, 112, 112, 77, 97, 110, 105, 102, 101, 115, 116, 46, 120, 109, 108, 46, 114, 101, 108, 115, 80, 75, 1, 2, 20, 0, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 186, 198, 161, 138, 248, 0, 0, 0, 48, 2, 0, 0, 59, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 246, 2, 0, 0, 95, 114, 101, 108, 115, 47, 102, 101, 97, 116, 117, 114, 101, 95, 101, 99, 102, 54, 98, 97, 101, 98, 45, 98, 48, 99, 57, 45, 52, 98, 52, 99, 45, 97, 56, 97, 50, 45, 98, 51, 50, 98, 48, 56, 97, 54, 100, 99, 102, 97, 46, 120, 109, 108, 46, 114, 101, 108, 115, 80, 75, 1, 2, 20, 0, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 4, 69, 15, 219, 222, 0, 0, 0, 17, 3, 0, 0, 19, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 71, 4, 0, 0, 91, 67, 111, 110, 116, 101, 110, 116, 95, 84, 121, 112, 101, 115, 93, 46, 120, 109, 108, 80, 75, 1, 2, 20, 0, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 244, 193, 250, 136, 18, 3, 0, 0, 37, 8, 0, 0, 85, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 86, 5, 0, 0, 101, 99, 102, 54, 98, 97, 101, 98, 45, 98, 48, 99, 57, 45, 52, 98, 52, 99, 45, 97, 56, 97, 50, 45, 98, 51, 50, 98, 48, 56, 97, 54, 100, 99, 102, 97, 47, 87, 101, 98, 80, 97, 114, 116, 95, 101, 99, 102, 54, 98, 97, 101, 98, 45, 98, 48, 99, 57, 45, 52, 98, 52, 99, 45, 97, 56, 97, 50, 45, 98, 51, 50, 98, 48, 56, 97, 54, 100, 99, 102, 97, 46, 120, 109, 108, 80, 75, 1, 2, 20, 0, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 237, 90, 181, 251, 223, 0, 0, 0, 45, 1, 0, 0, 48, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 219, 8, 0, 0, 102, 101, 97, 116, 117, 114, 101, 95, 101, 99, 102, 54, 98, 97, 101, 98, 45, 98, 48, 99, 57, 45, 52, 98, 52, 99, 45, 97, 56, 97, 50, 45, 98, 51, 50, 98, 48, 56, 97, 54, 100, 99, 102, 97, 46, 120, 109, 108, 80, 75, 1, 2, 20, 0, 10, 0, 0, 0, 8, 0, 128, 90, 243, 78, 185, 172, 165, 195, 152, 0, 0, 0, 189, 0, 0, 0, 59, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 10, 0, 0, 102, 101, 97, 116, 117, 114, 101, 95, 101, 99, 102, 54, 98, 97, 101, 98, 45, 98, 48, 99, 57, 45, 52, 98, 52, 99, 45, 97, 56, 97, 50, 45, 98, 51, 50, 98, 48, 56, 97, 54, 100, 99, 102, 97, 46, 120, 109, 108, 46, 99, 111, 110, 102, 105, 103, 46, 120, 109, 108, 80, 75, 5, 6, 0, 0, 0, 0, 8, 0, 8, 0, 178, 2, 0, 0, 249, 10, 0, 0, 0, 0]
        const data = new Uint8Array(x).buffer;
        console.log(data);
        // appCatalog.add("TEST0000000001");
        // const byteNumbers = new Array(shit.length);
        // for (let i = 0; i < shit.length; i++) {
        //     byteNumbers[i] = shit.charCodeAt(i);
        // }
        // const helloWorldWebpartSolution = new Uint8Array(byteNumbers);
        // // Uint8Array.from()

        const createdAppNames: string[] = [];
        before(async function () {
            appCatWeb = await sp.getTenantAppCatalogWeb();
            appCatalog = appCatWeb.getAppCatalog();
        });

        it("it gets all the apps", function () {
            return expect(appCatalog.get(), `all apps should've been fetched`).to.eventually.be.fulfilled;
        });

        it("it adds an app", function () {
            const appName: string = getRandomString(25);
            createdAppNames.push(appName);
            return expect(appCatalog.add(appName, data), `app '${appName}' should've been added`).to.eventually.be.fulfilled;
        });

        // it("it gets an app by id", async function () {
        //     const appName: string = getRandomString(25);
        //     createdAppNames.push(appName);
        //     const app = await appCatalog.add(appName, helloWorldWebpartSolution);
        //     const appId = app.data.UniqueId;
        //     return expect(appCatalog.getAppById(appId), `app '${appId}' should've been fetched`).to.eventually.be.fulfilled;
        // });

        after(async () => {
            // const listId = (await appCatWeb.lists.select("Id").filter(`EntityTypeName eq 'AppCatalog'`).get())[0].Id;
            // const appsForSharePointList = appCatWeb.lists.getById(listId);

            // return Promise.all(createdAppNames.map(async (appName) => {
            //     const item = await appsForSharePointList.items.filter(`FileLeafRef eq '${appName}'`).select("FileLeafRef,Id").get();
            //     return appsForSharePointList.items.getById(item[0].Id).delete();
            // }));
        });
    }
});
